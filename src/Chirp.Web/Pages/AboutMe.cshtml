@page "/user/{author}/about"
@using System.Security.Claims
@model Chirp.Web.Pages.AboutMeModel
@{
    ViewData["Title"] = "Chirp!";
    Layout = "Shared/_Layout";
}

<div>
    @if (User.Identity?.IsAuthenticated ?? false)
    {
        <h2>About Me</h2>
        <span>This is all the information stored about your <em>Chirp!</em> user:</span>
        <ul style="margin: 0 0 0 0; padding: 0 0 0 2em; line-height: 2;">
            <li><b>Username</b>: @Model.Username</li>
            <li><b>E-mail</b>: @Model.Email</li>
        </ul>
        <details style="margin: 0; padding: 0.4em 0 0 1.1em;" open>
            <summary style=""><b>Posted Cheeps:</b></summary>
            <ul style="margin-top: 0.2em; line-height: 1.8; list-style:none; padding-left: 1.5em;">
                @if (@Model.Cheeps.Count == 0)
                {
                    <li><i>No cheeps posted yet.</i></li>
                } 
                @foreach (var cheep in @Model.Cheeps) 
                {
                    <li>
                        <a style="" href="/user/@Model.Username">
                            @Model.Username:
                            @cheep.Text.Substring(0, Math.Min(16, cheep.Text.Length))... 
                            @cheep.DatePosted
                        </a>
                    </li>
                }
            </ul>
        </details>
        <details style="margin: 0; padding: 0.4em 0 0 1.1em;" open>
            <summary style=""><b>Followed Users:</b></summary>
            <ul style="margin-top: 0.2em; line-height: 1.8; list-style:none; padding-left: 1.5em;">
                @if (@Model.FollowedUsers.Count == 0)
                {
                    <li><i>Not following any users yet.</i></li>
                }
                @foreach (string username in @Model.FollowedUsers) {
                    <li>
                        <a style="" href="/user/@username">@username</a>
                    </li>
                }
            </ul>
        </details>

        <p>To download all your personal data, press the button below:</p>
        <form method="post">
            <button type="submit" asp-page-handler="DownloadUserData" style="margin-bottom: 0.5em">Download ZIP</button>
        </form>
    }
</div>