@page "/"
@model Chirp.Web.Pages.PublicModel
@{
ViewData["Title"] = "Chirp!";
Layout = "Shared/_Layout";
}

<div>
	@if (User.Identity !=null && User.Identity.IsAuthenticated) { <form method="post">
		@if (!string.IsNullOrEmpty(Model.ErrorMessage))
		{
		<div style="color: red; margin-bottom: 10px;">@Model.ErrorMessage</div>
		}
		<textarea asp-for="CheepMessage" required placeholder="Post a Cheep!" rows="4"
			style="width: 100%; box-sizing: border-box"></textarea>
		<br>
		<input type="submit" value="Post">
	</form>
	<hr>
	}

<<<<<<< HEAD
    <h2> Public Timeline </h2>
    <ul id="messagelist" class="cheeps">
    @if (Model.Cheeps.Any())
    {
        <ul class="cheeps-list" style="list-style:none; padding-left:0;">
            @foreach (var cheep in Model.Cheeps.Where(c => !c.ParentCheepID.HasValue)) //Renders only root node cheeps (replies gets rendered from _CheepPartial)
            {
                @await Html.PartialAsync("_CheepPartial", cheep)
            }
        </ul>
    }
    else
    {
        <em>There are no cheeps so far.</em>
    }
    </ul>
=======
	<h2> Public Timeline </h2>
	@if (Model.Cheeps.Any())
	{
	<ul id="messagelist" class="cheeps" ;">
		@foreach (var cheep in Model.Cheeps)
		{
		<div id="cheep-@cheep.CheepId">
			<li>
				<flex-container style="display:flex; height: 100%;">
					<div style="flex: 0 0 85%; margin: 0;">
						<p id="cheep_text" style="display: block;">
							<strong>
								<a href="/user/@cheep.AuthorName">@cheep.AuthorName</a>
							</strong>
							@cheep.Text
							<small>&mdash; @cheep.DatePosted</small>
							<small>&mdash; @cheep.Likes</small>
						</p>
						@if (User.Identity != null && User.Identity.IsAuthenticated &&
						@cheep.AuthorName == User.Identity.Name)
						{
						<form method="post" asp-page-handler="Edit" style="display: none;"
							id="cheep_edit">
							<input asp-for="EditedCheepText" type="text" value="@cheep.Text"
								style="width: 100%;" id="cheep_edit_input" required>
							<input asp-for="CheepIdForEditing" type="hidden"
								value="@cheep.CheepId">
							<input asp-for="CurrentPage" type="hidden"
								value="@Model.CurrentPage">
							<input type="submit" value="Finish">
						</form>
						}
					</div>
					<div style="flex: 0 0 15%;">
						@if (User.Identity != null && User.Identity.IsAuthenticated)
						{
						<form method="post" asp-page-handler="Like">
							<input asp-for="CheepIdForLike" type="hidden"
								value="@cheep.CheepId" ,>
							@if (Model.LikedCheepIds.Contains(cheep.CheepId))
							{
								<input type="submit" value="👎 Unlike"
									style="float:right; background:transparent; border-style:none; color:#CC6E6E; cursor:pointer; font-weight:bold;">
							}
							else
							{
								<input type="submit" value="👍 Like"
									style="float:right; background:transparent; border-style:none; color:#50CC6E; cursor:pointer;">
							}
						</form>
						}
						@if (User.Identity != null && User.Identity.IsAuthenticated &&
						@cheep.AuthorName
						== User.Identity.Name)
						{
						<form method="post" asp-page-handler="Delete">
							<input asp-for="CheepIdForDeletion" type="hidden"
								value="@cheep.CheepId">
							<input type="submit" value="Delete"
								style="float:right; background:transparent; border-style:none; color:#CC6E6E; cursor:pointer;">
						</form>
						<button type="button"
							style="float:right; background:transparent; border-style:none; color:#50CC6E; cursor:pointer;"
							onclick="editCheep(@cheep.CheepId)">
							Edit
						</button>
						}
					</div>
				</flex-container>
			</li>
		</div>
		}
	</ul>
	}
	else
	{
	<em>There are no cheeps so far.</em>
	}
>>>>>>> c1be465 (feat: add visual indicators for unliking)

	<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
        @if (Model.HasPreviousPage)
        {
            <a href="/?currentpage=@(Model.CurrentPage - 1)" style="font-size: 20px;">&larr;</a>
        }
        <span style="font-size: 16px;">Page @Model.CurrentPage</span>
        @if (Model.HasNextPage)
        {
            <a href="/?currentpage=@(Model.CurrentPage + 1)" style="font-size: 20px;">&rarr;</a>
        }
    </div>
</div>
